# 编解码器功能实现总结

## 已完成功能

### 1. 编解码器选择 UI（iOS 风格）
- **视频解码器选择页面** - 支持搜索、默认选项、自定义输入
- **音频解码器选择页面** - 支持搜索、默认选项、自定义输入
- **编码器选择对话框** - 远程检测、刷新按钮、筛选功能
- **统一设计风格** - 使用 DialogPage、SectionTitle、CompactTextField 等 iOS 风格组件

### 2. 会话数据扩展（SessionData）
**远程设备编码器缓存**：
- `codecCacheDeviceSerial` - 远程设备序列号（通过 `ro.serialno` 获取）
- `cachedVideoEncoders` - 视频编码器列表
- `cachedAudioEncoders` - 音频编码器列表
- `codecCacheTimestamp` - 缓存时间戳
- `isCodecCacheValid()` - 判断缓存有效性（30天过期）
- `getDeviceIdentifier()` - 获取设备唯一标识

### 3. 本地解码器持久化存储
**新增 LocalCodecCacheManager**：
- 使用 DataStore 持久化保存本地解码器列表
- 绑定本地设备 ANDROID_ID，设备变化时自动失效
- 提供 `saveVideoDecoders()` / `saveAudioDecoders()` 方法
- 30天缓存有效期，过期自动重新检测

### 4. 国际化文本
新增解码器相关文本：
- `SECTION_DECODER_OPTIONS` - 解码器选项
- `SECTION_DETECTED_DECODERS` - 检测到的解码器
- `LABEL_VIDEO_DECODER` / `LABEL_AUDIO_DECODER` - 标签
- `PLACEHOLDER_CUSTOM_DECODER` / `PLACEHOLDER_SEARCH_DECODER` - 占位符
- `STATUS_NO_DECODERS_DETECTED` - 状态提示

## 数据存储架构

### 编码器（远程设备）
- **存储位置**：SessionData（会话数据）
- **唯一标识**：设备序列号（`ro.serialno`）
- **更新时机**：用户点击刷新 或 设备序列号变化

### 解码器（本地设备）
- **存储位置**：LocalCodecCacheManager（全局设置）
- **唯一标识**：本地 ANDROID_ID
- **更新时机**：设备 ID 变化 或 缓存过期（30天）

## 将来可用场景

1. **智能推荐** - 连接时根据缓存自动选择最优编解码器
2. **快速启动** - 避免每次连接都重新检测编解码器
3. **数据分析** - 了解用户设备支持的编解码器类型
4. **离线使用** - 无需网络即可查看历史检测结果

## 技术特点

- **持久化存储** - 使用 DataStore，数据不丢失
- **设备绑定** - 自动识别设备变化，确保数据准确性
- **缓存策略** - 30天有效期，平衡性能与准确性
- **iOS 风格** - 统一的 UI 设计，用户体验一致